{% schema %}
{
  "name": "Collection Carousel",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection"
    }
  ],
  "presets": [
    {
      "name": "Collection Carousel",
      "category": "Custom"
    }
  ]
}
{% endschema %}

{% if section.settings.collection != blank %}
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<h2 class="carousel-heading">Trending</h2>
  <div class="product-carousel owl-carousel">
    {% assign selected_collection = collections[section.settings.collection] %}
    {% for product in selected_collection.products %}
      <div class="item">
        <div class="product-card" data-product-id="{{ product.id }}">
          <a href="{{ product.url }}" class="image-container">
            <img src="{{ product.featured_image | img_url: '600x450' }}" alt="{{ product.title }}">
          </a>
          <div class="info-row">
            <div class="info-left">
              <a href="{{ product.url }}"><h3>{{ product.title }}</h3></a>
              <p>
  <p class="custom-description">{{ product.collections.first.title }}</p>
</p>
              <p class="price">{{ product.price | money }}</p>
            </div>
            <div class="info-right">
              <button class="wishlist-btn" title="Add to Wishlist" data-product-handle="{{ product.handle }}">♡</button>
              <button class="add-to-cart-btn" data-variant-id="{{ product.variants.first.id }}">Add to Cart</button>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>Please select a collection in the section settings.</p>
{% endif %}

<!-- Owl Carousel CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" />

<style>
.product-card {
  font-family: 'Montserrat', sans-serif;
  border: 1px solid #eee;
  overflow: hidden;
  background: #fff;
  display: flex;
  flex-direction: column;
  transition: box-shadow 0.3s;
  padding-bottom: 10px;
}
 .carousel-heading {
  font-family: 'Montserrat', sans-serif;
  font-size: 22px;
  font-weight: 600;
  text-align: center;
  text-transform: uppercase;
  margin: 20px 0 20px;
  padding-left: 5px;
}


.product-card:hover {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

.image-container {
  width: 100%;
  aspect-ratio: 5 / 6;
  overflow: hidden;
  display: block;
}

.image-container img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position:top center;
  display: block;
  border-radius: 0;
}

.info-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 8px 10px;
  gap: 10px;
}

.info-left {
  flex: 0 0 60%;
}

.info-left h3 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  line-height: 1.4;
}

.info-left h3 a {
  text-decoration: none;
  color: inherit;
}

.info-left .price {
  font-size: 14px;
  font-weight: 600;
  color: #222;
  margin: 4px 0;
}

.info-left p {
  font-size: 12px;
  color: #555;
  margin-top: 2px;
  line-height: 1.3;
}

.info-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
}

.wishlist-btn {
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: #000;
  transition: color 0.3s;
}

.wishlist-btn:hover {
  background: none;
  color: #808080;
 
}

.wishlist-btn.active {
  color: #000;
}

.add-to-cart-btn {
  background-color: #000;
  color: #fff;
  border: none;
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 5px;
  cursor: pointer;
  visibility: hidden;
  opacity: 0;
  transform: translateY(5px);
  transition: all 0.3s ease;
}

.product-card:hover .add-to-cart-btn {
  visibility: visible;
  opacity: 1;
  transform: translateY(0);
}

.owl-carousel .owl-stage-outer {
  padding: 0;
}

.owl-carousel .item {
  padding: 0;
  margin-right: 1px;
}

.owl-nav button.owl-prev,
.owl-nav button.owl-next {
  background: transparent;
  border: none;
  font-size: 30px;
  color: #333;
  margin: 0 5px;
}
  /* Your existing styles stay unchanged... */

.owl-carousel .item {
  
  padding: 0;
  margin-right: 1px;
  width: 100%; /* 5 items per row on desktop */
}

/* Tablet view — show 3 items per row */
@media screen and (max-width: 1024px) {
  .owl-carousel .item {
    width: 33.33%;
  }
}

/* Mobile view — show 3 items per row */
@media screen and (max-width: 768px) {
  .owl-carousel .item {
    width: 33.33%;
  }
}

/* Extra small mobile — show 1 full-width item */
@media screen and (max-width: 480px) {
  .owl-carousel .item {
    width: 100%;
  }
   .info-left h3 {
  margin: 0;
  font-size: 0.5rem;
  font-weight: 600;
  line-height: 1;
}
  .info-left p {
  font-size: 0.4rem;
  color: #555;
  margin-top: 2px;
  line-height: 1;
}
.info-left .price {
  font-size: 0.5rem;
  font-weight: 600;
  color: #222;
  margin: 4px 0;
}
.add-to-cart-btn {
  background-color: #000;
  color: #fff;
  border: none;
  padding: 2px 5px;
  font-size: 0.5rem;
  border-radius: 5px;
  cursor: pointer;
  visibility: hidden;
  opacity: 0;
  transform: translateY(5px);
  transition: all 0.3s ease;
}
}

</style>

<!-- Owl Carousel JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" defer></script>

<script defer>
  document.addEventListener("DOMContentLoaded", function () {
    $('.product-carousel').owlCarousel({
      loop: true,
      margin: 5,
      nav: true,
      dots: false,
      responsive: {
        0: { items: 2 },
        480: { items: 2 },
        768: { items: 3 },
        992: { items: 4 }
      }
    });

    const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];

    document.querySelectorAll('.wishlist-btn').forEach(btn => {
      const handle = btn.dataset.productHandle;
      if (wishlist.includes(handle)) {
        btn.classList.add('active');
        btn.innerText = '♥';
      }

      btn.addEventListener('click', function () {
        if (wishlist.includes(handle)) {
          wishlist.splice(wishlist.indexOf(handle), 1);
          btn.classList.remove('active');
          btn.innerText = '♡';
        } else {
          wishlist.push(handle);
          btn.classList.add('active');
          btn.innerText = '♥';
        }
        localStorage.setItem('wishlist', JSON.stringify(wishlist));
      });
    });

    document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
      btn.addEventListener('click', function () {
        const variantId = btn.dataset.variantId;
        fetch('/cart/add.js', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id: variantId, quantity: 1 })
        })
        .then(res => res.json())
        .then(data => {
          alert(`✅ Added "${data.title}" to your cart.`);
        })
        .catch(err => {
          console.error(err);
          alert('❌ Something went wrong.');
        });
      });
    });
  });
</script>
